(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports=a(20)},18:function(e,t,a){},19:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(4),o=a.n(i),s=(a(18),a(2)),c=a(5),l=a(6),u=a(7),d=a(10),m=a(8),h=a(11),p=a(1),f=(a(19),function(e){var t=e.topics,a=e.joinNewTopicDiscussion;if(!t)return"";var r=Object.values(t).map(function(e){return n.a.createElement("li",{key:e.key,onClick:function(){return a({key:e.key})}},n.a.createElement("div",{className:"topics"},n.a.createElement("div",{className:"topics-title"},n.a.createElement("p",null,"Title: ",e.title)),n.a.createElement("div",{className:"meta-info"},n.a.createElement("div",{className:"sender-info"},n.a.createElement("span",{className:"username"},"by ",e.sender)),n.a.createElement("div",{className:"message-info"},n.a.createElement("span",{className:"timestamp"},new Date(e.timestamp).toDateString())),n.a.createElement("div",{className:"replies-info"},n.a.createElement("span",{className:"replies-nums"},"Replies: ",e.topicChat.messages.length)))))});return n.a.createElement("ul",{className:"topics-list"},r)}),g=function(e){e.allUsers;var t=e.allTopics,a=e.topicChatInfo,r=e.handleTopicChatSubmit,i=e.handleTopicChatChange,o=e.topicChatdisabled,s=e.joinNewTopicDiscussion;return n.a.createElement("div",{className:"chat-app"},n.a.createElement("div",{className:"display-panel"},n.a.createElement(f,{topics:t,topicChatInfo:a,handleSubmit:r,handleChange:i,disabled:o,joinNewTopicDiscussion:s})))},v=function(e){var t=e.errorMessage;if(!t)return n.a.createElement("div",{className:"show-errors"});var a=0,r=Object.values(t).map(function(e){return n.a.createElement("li",{key:a++},n.a.createElement("div",{className:"error-message"},n.a.createElement("span",{className:"error"},e.toString())))});return n.a.createElement("div",{className:"show-errors"},n.a.createElement("ul",{className:"show-errors-list"},r))},E=function(e){var t=e.updateSender,a=e.value,r=e.disabled,i=e.handleSubmit;return n.a.createElement("div",{className:"login"},n.a.createElement("form",null,n.a.createElement("input",{name:"username",placeholder:"Enter Username",value:a,onChange:function(e){return t(e.target.value)}}),n.a.createElement("button",{onClick:function(e){return i(e)},disabled:r},"Login")))},b=function(e){var t=e.username;return n.a.createElement("div",{className:"greeting"},n.a.createElement("p",{className:"greeting"},"Hi, ",t))},T=function(e){var t=e.logout;return n.a.createElement("div",{className:"logout"},n.a.createElement("button",{onClick:t},"Logout"))},y=function(e){var t=e.updateSender,a=e.value,r=e.handleSubmit,i=e.disabled,o=e.isLogged,s=e.logout,c=e.backToMainPage,l=e.gotoNewTopicPage;return n.a.createElement("div",{className:"navigation-bar"},n.a.createElement("div",{className:"all-links"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",{className:"back-to-mainpage",onClick:function(){return c()}},"Main Page")),n.a.createElement("li",null,n.a.createElement("p",{className:"new-topic",onClick:function(){return l()}},"New topic")))),o?n.a.createElement("div",{className:"login-status-div"},n.a.createElement(b,{username:o}),n.a.createElement(T,{logout:s})):n.a.createElement("div",{className:"login-status-div"},n.a.createElement(E,{updateSender:t,value:a,handleSubmit:r,disabled:i})))},S=a(9),k=a.n(S),C=function(){return n.a.createElement("div",{className:"logo"},n.a.createElement("img",{src:k.a,alt:"Logo"}))},N=function(e){var t=e.topicChatInfo,a=e.handleSubmit,r=e.handleChange,i=(e.keyPress,e.disabled),o=e.topicId;return n.a.createElement("div",{className:"reply-outgoing"},n.a.createElement("label",null,"Reply to this Topic:"),n.a.createElement("textarea",{className:"to-send-message",value:t,placeholder:"Enter message to send",onChange:function(e){return r(e)}}),n.a.createElement("button",{disabled:i,onClick:function(e){return a({e:e,topicId:o})}},"Send"))},j=function(e){if(e)return{__html:e.replace(/(?:\r\n|\r|\n)/g,"<br/>")}},w=function(e){var t=e.messages,a=0,r=t.map(function(e){return n.a.createElement("li",{key:a++},n.a.createElement("div",{className:"discussion"},n.a.createElement("div",{className:"meta-info"},n.a.createElement("div",{className:"sender-info"},n.a.createElement("span",{className:"username"},e.sender)),n.a.createElement("div",{className:"message-info"},n.a.createElement("span",{className:"timestamp"},new Date(e.timestamp).toDateString()))),n.a.createElement("p",{className:"message-text",dangerouslySetInnerHTML:j(e.text)})))});return n.a.createElement("div",{className:"disscussions"},n.a.createElement("ul",{className:"disscussions-list"},r))},O=function(e){var t=e.title,a=e.sender,r=e.timestamp,i=e.topicText;return n.a.createElement("div",{className:"topic-details"},n.a.createElement("div",{className:"topic-title"},n.a.createElement("h1",null,t)),n.a.createElement("div",{className:"topic-Info"},n.a.createElement("div",{className:"topic-meta-info"},n.a.createElement("div",{className:"sender-info"},n.a.createElement("span",{className:"username"},a)),n.a.createElement("div",{className:"message-info"},n.a.createElement("span",{className:"timestamp"},new Date(r).toDateString()))),n.a.createElement("p",{className:"message-text",dangerouslySetInnerHTML:j(i)})))},I=function(e){var t=e.topic,a=e.topicChatInfo,r=e.handleTopicChatSubmit,i=e.handleTopicChatChange,o=e.topicChatdisabled;return t?n.a.createElement("div",{className:"chat-app"},n.a.createElement("div",{className:"display-panel"},n.a.createElement(O,{title:t.title,sender:t.sender,timestamp:t.timestamp,topicText:t.text}),n.a.createElement(w,{messages:t.topicChat.messages})),n.a.createElement("div",{className:"send-panel"},n.a.createElement(N,{topicChatInfo:a,handleSubmit:r,handleChange:i,disabled:o,topicId:t.key}))):""},P=function(e){var t=e.title,a=e.handleTitleChange,r=e.topicInfo,i=e.handleSubmit,o=e.handleChange,s=(e.keyPress,e.disabled);return n.a.createElement("div",{className:"send-panel"},n.a.createElement("div",{className:"outgoing"},n.a.createElement("div",{className:"outgoing-title"},n.a.createElement("label",null,"Title:"),n.a.createElement("input",{className:"to-send-title",onChange:function(e){return a(e)},value:t,placeholder:"Enter title to send"})),n.a.createElement("div",{className:"outgoing-topic"},n.a.createElement("label",null,"Topic:"),n.a.createElement("textarea",{className:"to-send-message",value:r,placeholder:"Enter message to send",onChange:function(e){return o(e)}})),n.a.createElement("button",{disabled:s,onClick:i},"Send")))},D=function(){return n.a.createElement("div",{className:"lds-ring"},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null))},M=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this))).state={title:"",topicInfo:"",topicChatInfo:"",tempsender:"",currentPage:"main"},e.backToMainPage=e.backToMainPage.bind(Object(p.a)(Object(p.a)(e))),e.handleChange=e.handleChange.bind(Object(p.a)(Object(p.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(Object(p.a)(e))),e.handleLoginSubmit=e.handleLoginSubmit.bind(Object(p.a)(Object(p.a)(e))),e.handleTitleChange=e.handleTitleChange.bind(Object(p.a)(Object(p.a)(e))),e.handleTopicChatChange=e.handleTopicChatChange.bind(Object(p.a)(Object(p.a)(e))),e.handleTopicChatSubmit=e.handleTopicChatSubmit.bind(Object(p.a)(Object(p.a)(e))),e.joinNewTopicDiscussion=e.joinNewTopicDiscussion.bind(Object(p.a)(Object(p.a)(e))),e.updateSender=e.updateSender.bind(Object(p.a)(Object(p.a)(e))),e.currentPage=e.currentPage.bind(Object(p.a)(Object(p.a)(e))),e.logout=e.logout.bind(Object(p.a)(Object(p.a)(e))),e.gotoNewTopicPage=e.gotoNewTopicPage.bind(Object(p.a)(Object(p.a)(e))),e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"backToMainPage",value:function(){var e=this;this.showloading(),this.updateTopicsState(),setTimeout(function(){e.setState({topic:"",currentPage:"main",error:""})},500)}},{key:"updateSender",value:function(e){e&&this.setState({tempsender:e})}},{key:"getStateError",value:function(){return this.state.error}},{key:"setStateError",value:function(e){var t=e.err,a=e.errorType;a&&this.setState(function(e){return{error:Object(c.a)({},e.error,Object(s.a)({},a,t))}})}},{key:"handleLoginSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.tempsender;!function(e){var t=e.username,a=e.callback;fetch("/login/".concat(t),{method:"POST",headers:new Headers({"content-type":"application/json"})}).catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){if(!e.ok)return e.json();a({err:"",errorType:"LoginError"})}).then(function(e){if(e)throw new Error(e.error)}).catch(function(e){return a({err:e,errorType:"LoginError"})})}({username:a,callback:function(e){var a=e.err,r=e.errorType;t.setStateError({err:a,errorType:r})}}),this.setState({sender:a,tempsender:""})}},{key:"handleTitleChange",value:function(e){this.setState({title:e.target.value})}},{key:"handleChange",value:function(e){this.setState({topicInfo:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),this.state.topicInfo){var a=this.state.sender,r=this.state.topicInfo;(function(e){var t=e.title,a=e.username,r=e.text,n=e.callback;return fetch("/topics/",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({title:t,username:a,text:r})}).catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){return e.ok?(n({err:"",errorType:"sendMessageError"}),e.json()):e.json()}).then(function(e){if(e.error)throw new Error(e.error);return e.topicId}).catch(function(e){return n({err:e,errorType:"sendMessageError"})})})({title:this.state.title,username:a,text:r,callback:function(e){var a=e.err,r=e.errorType;t.setStateError({err:a,errorType:r})}}).then(function(e){t.joinNewTopicDiscussion({key:e})}),this.setState({topicInfo:"",title:""})}}},{key:"updateUsersState",value:function(){var e=this;(function(e){var t=e.callback;return fetch("/users/").catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){if(e.ok)return t({err:"",errorType:"updateUserError"}),e.json();throw new Error("Couldn't get User data!")}).catch(function(e){return t({err:e,errorType:"updateUserError"})})})({callback:function(t){var a=t.err,r=t.errorType;e.setStateError({err:a,errorType:r})}}).then(function(t){e.setState({allUsers:t})})}},{key:"updateTopicsState",value:function(){var e=this;(function(e){var t=e.callback;return fetch("/topics/").catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){if(e.ok)return t({err:"",errorType:"UpdateMessageError"}),e.json();throw new Error("Couldn't get Message data!")}).catch(function(e){return t({err:e,errorType:"UpdateMessageError"})})})({callback:function(t){var a=t.err,r=t.errorType;e.setStateError({err:a,errorType:r})}}).then(function(t){e.setState({allTopics:t})})}},{key:"getAllUsersAndTopics",value:function(){this.updateUsersState(),this.updateTopicsState()}},{key:"logout",value:function(){var e=this;!function(e){var t=e.username,a=e.callback;fetch("/logout/".concat(t),{method:"POST",headers:new Headers({"content-type":"application/json"})}).catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){if(!e.ok)return e.json();a({err:"",errorType:"LogoutError"})}).then(function(e){if(e)throw new Error(e.error)}).catch(function(e){return a({err:e,errorType:"LogoutError"})})}({username:this.state.sender,callback:function(t){var a=t.err,r=t.errorType;e.setStateError({err:a,errorType:r})}}),delete this.state.sender,this.setState(this.state)}},{key:"componentDidMount",value:function(){var e=this;this.getAllUsersAndTopics(),setInterval(function(){e.state.topic?e.updateTopicDiscussion({key:e.state.topic.key}):e.getAllUsersAndTopics()},5e3)}},{key:"checkDisabled",value:function(){return!this.state.topicInfo}},{key:"handleTopicChatSubmit",value:function(e){var t=this,a=e.e,r=e.topicId;a.preventDefault();(function(e){var t=e.username,a=e.text,r=e.topicId,n=e.callback;return fetch("/topicDiscussion/".concat(r),{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:t,text:a})}).catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){return e.ok?(n({err:"",errorType:"SendDisscussionError"}),JSON.stringify({isloading:!0})):e.json()}).then(function(e){if(e.error)throw new Error(e.error);return e}).catch(function(e){return n({err:e,errorType:"SendDisscussionError"})})})({username:this.state.sender,text:this.state.topicChatInfo,topicId:r,callback:function(e){var a=e.err,r=e.errorType;t.setStateError({err:a,errorType:r})}}).then(function(e){e&&(t.updateTopicDiscussion({key:r}),t.setState({topicChatInfo:"",error:""}))})}},{key:"handleTopicChatChange",value:function(e){this.setState({topicChatInfo:e.target.value})}},{key:"showloading",value:function(){this.setState({error:"",currentPage:"loading"})}},{key:"joinNewTopicDiscussion",value:function(e){var t=this,a=e.key;a&&(this.showloading(),setTimeout(function(){return t.updateTopicDiscussion({key:a})},1e3))}},{key:"updateTopicDiscussion",value:function(e){var t=this,a=e.key;if(a){(function(e){var t=e.topicId,a=e.callback;return fetch("/topicDiscussion/".concat(t)).catch(function(e){return Promise.reject({err:e,errorType:"service-error"})}).then(function(e){if(e.ok)return a({err:"",errorType:"UpdateDisscussionError"}),e.json();throw new Error("Couldn't get Disscussion data!")}).catch(function(e){return a({err:e,errorType:"UpdateDisscussionError"})})})({topicId:a,callback:function(e){var a=e.err,r=e.errorType;t.setStateError({err:a,errorType:r})}}).then(function(e){t.setState({topic:e,currentPage:"topicDiscussion"})})}}},{key:"currentPage",value:function(){return"topicDiscussion"===this.state.currentPage?n.a.createElement(I,{topic:this.state.topic,topicChatInfo:this.state.topicChatInfo,handleTopicChatSubmit:this.handleTopicChatSubmit,handleTopicChatChange:this.handleTopicChatChange,topicChatdisabled:!this.state.topicChatInfo}):"newTopic"===this.state.currentPage?n.a.createElement(P,{title:this.state.title,handleTitleChange:this.handleTitleChange,topicInfo:this.state.topicInfo,handleSubmit:this.handleSubmit,handleChange:this.handleChange,disabled:!this.state.title||!this.state.topicInfo}):"main"===this.state.currentPage?n.a.createElement(g,{allUsers:this.state.allUsers,allTopics:this.state.allTopics,joinNewTopicDiscussion:this.joinNewTopicDiscussion,topicChatInfo:this.state.topicChatInfo,handleTopicChatSubmit:this.handleTopicChatSubmit,handleTopicChatChange:this.handleTopicChatChange,topicChatdisabled:!this.state.topicChatInfo}):"loading"===this.state.currentPage?n.a.createElement(D,null):void 0}},{key:"gotoNewTopicPage",value:function(){this.setState({currentPage:"newTopic",topic:"",error:""})}},{key:"render",value:function(){return n.a.createElement("div",{id:"chat-app"},n.a.createElement(C,null),n.a.createElement(y,{updateSender:this.updateSender,value:this.state.tempsender,handleSubmit:this.handleLoginSubmit,disabled:!this.state.tempsender,isLogged:this.state.sender,logout:this.logout,backToMainPage:this.backToMainPage,gotoNewTopicPage:this.gotoNewTopicPage}),this.currentPage(),n.a.createElement("div",{className:"error-report"},n.a.createElement(v,{errorMessage:this.state.error})))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a.p+"static/media/logo.f5b14d15.jpg"}},[[12,1,2]]]);
//# sourceMappingURL=main.647a3c56.chunk.js.map